
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GeoJSON, Turf.js, and Google Maps Example</title>
  <script src='https://unpkg.com/@turf/turf@6/turf.min.js'></script>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyADd7NKHfGXY1FLZn4z260m0pwnhFcA1gE&libraries=places"></script>
  <style>
    body {
      display: flex;
    }
    #searchContainer {
      width: 50%;
      display: flex;
      flex-direction: column;
      height: 100vh; /* Full height of the viewport */
      padding: 10px;
      justify-content: space-between; /* Distributes space evenly */
    }
    #map {
      height: 100vh; /* Full height of the viewport */
      width: 50%;
    }
    #searchBox {
      width: 100%;
      box-sizing: border-box;
      border: 2px solid #ccc;
      border-radius: 4px;
      font-size: 16px;
      background-color: white;
      padding: 12px 20px 12px 40px;
    }
    #checkLocationBtn {
      align-self: center; /* Aligns the button to the center of its container */
    }
    .card {
      width: 100%; /* Full width of the container */
      margin-bottom: 10px; /* Space between cards */
    }
    * {
      border: solid red 1px;
      /*outline: dot-dot-dash green 1px;*/
    }
  </style>
</head>
<body>
<div id="searchContainer">
  <input id="searchBox" type="text" placeholder="Enter an address...">

  <button id="checkLocationBtn">Check My Location</button>

  <div class="container-fluid" style="font-family: 'Lato', sans-serif;">
    <div class="row">
      <!-- Vertically scrollable container with two columns and four rows -->
      <div class="col-6" style="height: 800px; overflow-y: auto;">
        <div style="display: grid; grid-template-columns: repeat(2, 1fr); grid-gap: 10px;">
          <!-- Repeat for each card, total 8 cards for 2 columns and 4 rows -->
          <div class="card" style="width: 100%; max-width: 200px; margin-bottom: 10px; border: solid red 1px;">
            <div class="photo placeholder-img" style="height: 120px; background-position: center; background-repeat: no-repeat; background-size: cover; display: flex; justify-content: space-between; background-image: url('https://www.stlouis.style/wp-content/uploads/2016/06/flwright-ebsworth-house-1.jpg');">
              <div class="time" style="background: rgba(0,0,0,.54); padding: 5px 10px; display: inline-block; color: white; font-size: 0.8em;height: 19%;">2 days ago</div>
              <div class="heart static" style="width: 40px; height: 40px; display: flex; justify-content: center;">
                <svg id="heart" width="30px" height="30px" style="align-self: center;">
                  <path id="heart-path" class="no-love" style="fill: none; stroke: white; stroke-width: 2px;" d="M 20 9 V 9 C 24 0 32 0 36 8.64 S 20 30 20 30.24 C 20 30.24 20 30 20 30.24 S 0 17.28 4 8.64 C 8 0 16 0 20 9"></path>
                </svg>
              </div>
            </div>
            <div class="description" style="padding: 8px;">
              <div class="price" style="font-size: 1.2em; font-weight: bolder;">$263,000</div>
              <div class="info" style="font-size: 0.75em;">2 bds 3 ba 1,900 sqft - For sale by realtor</div>
              <div class="address" style="font-size: 0.75em;">120 North Ballas Road, Kirkwood, MO 63122</div>
            </div>
          </div>
          <div class="card" style="width: 100%; max-width: 200px; margin-bottom: 10px; border: solid red 1px;">
            <div class="photo placeholder-img" style="height: 120px; background-position: center; background-repeat: no-repeat; background-size: cover; display: flex; justify-content: space-between; background-image: url('https://www.stlouis.style/wp-content/uploads/2016/06/flwright-ebsworth-house-1.jpg');">
              <div class="time" style="background: rgba(0,0,0,.54); padding: 5px 10px; display: inline-block; color: white; font-size: 0.8em;height: 19%;">2 days ago</div>
              <div class="heart static" style="width: 40px; height: 40px; display: flex; justify-content: center;">
                <svg id="heart" width="30px" height="30px" style="align-self: center;">
                  <path id="heart-path" class="no-love" style="fill: none; stroke: white; stroke-width: 2px;" d="M 20 9 V 9 C 24 0 32 0 36 8.64 S 20 30 20 30.24 C 20 30.24 20 30 20 30.24 S 0 17.28 4 8.64 C 8 0 16 0 20 9"></path>
                </svg>
              </div>
            </div>
            <div class="description" style="padding: 8px;">
              <div class="price" style="font-size: 1.2em; font-weight: bolder;">$263,000</div>
              <div class="info" style="font-size: 0.75em;">2 bds 3 ba 1,900 sqft - For sale by realtor</div>
              <div class="address" style="font-size: 0.75em;">120 North Ballas Road, Kirkwood, MO 63122</div>
            </div>
          </div>
          <div class="card" style="width: 100%; max-width: 200px; margin-bottom: 10px; border: solid red 1px;">
            <div class="photo placeholder-img" style="height: 120px; background-position: center; background-repeat: no-repeat; background-size: cover; display: flex; justify-content: space-between; background-image: url('https://www.stlouis.style/wp-content/uploads/2016/06/flwright-ebsworth-house-1.jpg');">
              <div class="time" style="background: rgba(0,0,0,.54); padding: 5px 10px; display: inline-block; color: white; font-size: 0.8em;height: 19%;">2 days ago</div>
              <div class="heart static" style="width: 40px; height: 40px; display: flex; justify-content: center;">
                <svg id="heart" width="30px" height="30px" style="align-self: center;">
                  <path id="heart-path" class="no-love" style="fill: none; stroke: white; stroke-width: 2px;" d="M 20 9 V 9 C 24 0 32 0 36 8.64 S 20 30 20 30.24 C 20 30.24 20 30 20 30.24 S 0 17.28 4 8.64 C 8 0 16 0 20 9"></path>
                </svg>
              </div>
            </div>
            <div class="description" style="padding: 8px;">
              <div class="price" style="font-size: 1.2em; font-weight: bolder;">$263,000</div>
              <div class="info" style="font-size: 0.75em;">2 bds 3 ba 1,900 sqft - For sale by realtor</div>
              <div class="address" style="font-size: 0.75em;">120 North Ballas Road, Kirkwood, MO 63122</div>
            </div>
          </div>
          <div class="card" style="width: 100%; max-width: 200px; margin-bottom: 10px; border: solid red 1px;">
            <div class="photo placeholder-img" style="height: 120px; background-position: center; background-repeat: no-repeat; background-size: cover; display: flex; justify-content: space-between; background-image: url('https://www.stlouis.style/wp-content/uploads/2016/06/flwright-ebsworth-house-1.jpg');">
              <div class="time" style="background: rgba(0,0,0,.54); padding: 5px 10px; display: inline-block; color: white; font-size: 0.8em;height: 19%;">2 days ago</div>
              <div class="heart static" style="width: 40px; height: 40px; display: flex; justify-content: center;">
                <svg id="heart" width="30px" height="30px" style="align-self: center;">
                  <path id="heart-path" class="no-love" style="fill: none; stroke: white; stroke-width: 2px;" d="M 20 9 V 9 C 24 0 32 0 36 8.64 S 20 30 20 30.24 C 20 30.24 20 30 20 30.24 S 0 17.28 4 8.64 C 8 0 16 0 20 9"></path>
                </svg>
              </div>
            </div>
            <div class="description" style="padding: 8px;">
              <div class="price" style="font-size: 1.2em; font-weight: bolder;">$263,000</div>
              <div class="info" style="font-size: 0.75em;">2 bds 3 ba 1,900 sqft - For sale by realtor</div>
              <div class="address" style="font-size: 0.75em;">120 North Ballas Road, Kirkwood, MO 63122</div>
            </div>
          </div>
          <div class="card" style="width: 100%; max-width: 200px; margin-bottom: 10px; border: solid red 1px;">
            <div class="photo placeholder-img" style="height: 120px; background-position: center; background-repeat: no-repeat; background-size: cover; display: flex; justify-content: space-between; background-image: url('https://www.stlouis.style/wp-content/uploads/2016/06/flwright-ebsworth-house-1.jpg');">
              <div class="time" style="background: rgba(0,0,0,.54); padding: 5px 10px; display: inline-block; color: white; font-size: 0.8em;height: 19%;">2 days ago</div>
              <div class="heart static" style="width: 40px; height: 40px; display: flex; justify-content: center;">
                <svg id="heart" width="30px" height="30px" style="align-self: center;">
                  <path id="heart-path" class="no-love" style="fill: none; stroke: white; stroke-width: 2px;" d="M 20 9 V 9 C 24 0 32 0 36 8.64 S 20 30 20 30.24 C 20 30.24 20 30 20 30.24 S 0 17.28 4 8.64 C 8 0 16 0 20 9"></path>
                </svg>
              </div>
            </div>
            <div class="description" style="padding: 8px;">
              <div class="price" style="font-size: 1.2em; font-weight: bolder;">$263,000</div>
              <div class="info" style="font-size: 0.75em;">2 bds 3 ba 1,900 sqft - For sale by realtor</div>
              <div class="address" style="font-size: 0.75em;">120 North Ballas Road, Kirkwood, MO 63122</div>
            </div>
          </div>
          <div class="card" style="width: 100%; max-width: 200px; margin-bottom: 10px; border: solid red 1px;">
            <div class="photo placeholder-img" style="height: 120px; background-position: center; background-repeat: no-repeat; background-size: cover; display: flex; justify-content: space-between; background-image: url('https://www.stlouis.style/wp-content/uploads/2016/06/flwright-ebsworth-house-1.jpg');">
              <div class="time" style="background: rgba(0,0,0,.54); padding: 5px 10px; display: inline-block; color: white; font-size: 0.8em;height: 19%;">2 days ago</div>
              <div class="heart static" style="width: 40px; height: 40px; display: flex; justify-content: center;">
                <svg id="heart" width="30px" height="30px" style="align-self: center;">
                  <path id="heart-path" class="no-love" style="fill: none; stroke: white; stroke-width: 2px;" d="M 20 9 V 9 C 24 0 32 0 36 8.64 S 20 30 20 30.24 C 20 30.24 20 30 20 30.24 S 0 17.28 4 8.64 C 8 0 16 0 20 9"></path>
                </svg>
              </div>
            </div>
            <div class="description" style="padding: 8px;">
              <div class="price" style="font-size: 1.2em; font-weight: bolder;">$263,000</div>
              <div class="info" style="font-size: 0.75em;">2 bds 3 ba 1,900 sqft - For sale by realtor</div>
              <div class="address" style="font-size: 0.75em;">120 North Ballas Road, Kirkwood, MO 63122</div>
            </div>
          </div>
          <div class="card" style="width: 100%; max-width: 200px; margin-bottom: 10px; border: solid red 1px;">
            <div class="photo placeholder-img" style="height: 120px; background-position: center; background-repeat: no-repeat; background-size: cover; display: flex; justify-content: space-between; background-image: url('https://www.stlouis.style/wp-content/uploads/2016/06/flwright-ebsworth-house-1.jpg');">
              <div class="time" style="background: rgba(0,0,0,.54); padding: 5px 10px; display: inline-block; color: white; font-size: 0.8em;height: 19%;">2 days ago</div>
              <div class="heart static" style="width: 40px; height: 40px; display: flex; justify-content: center;">
                <svg id="heart" width="30px" height="30px" style="align-self: center;">
                  <path id="heart-path" class="no-love" style="fill: none; stroke: white; stroke-width: 2px;" d="M 20 9 V 9 C 24 0 32 0 36 8.64 S 20 30 20 30.24 C 20 30.24 20 30 20 30.24 S 0 17.28 4 8.64 C 8 0 16 0 20 9"></path>
                </svg>
              </div>
            </div>
            <div class="description" style="padding: 8px;">
              <div class="price" style="font-size: 1.2em; font-weight: bolder;">$263,000</div>
              <div class="info" style="font-size: 0.75em;">2 bds 3 ba 1,900 sqft - For sale by realtor</div>
              <div class="address" style="font-size: 0.75em;">120 North Ballas Road, Kirkwood, MO 63122</div>
            </div>
          </div>
          <div class="card" style="width: 100%; max-width: 200px; margin-bottom: 10px; border: solid red 1px;">
            <div class="photo placeholder-img" style="height: 120px; background-position: center; background-repeat: no-repeat; background-size: cover; display: flex; justify-content: space-between; background-image: url('https://www.stlouis.style/wp-content/uploads/2016/06/flwright-ebsworth-house-1.jpg');">
              <div class="time" style="background: rgba(0,0,0,.54); padding: 5px 10px; display: inline-block; color: white; font-size: 0.8em;height: 19%;">2 days ago</div>
              <div class="heart static" style="width: 40px; height: 40px; display: flex; justify-content: center;">
                <svg id="heart" width="30px" height="30px" style="align-self: center;">
                  <path id="heart-path" class="no-love" style="fill: none; stroke: white; stroke-width: 2px;" d="M 20 9 V 9 C 24 0 32 0 36 8.64 S 20 30 20 30.24 C 20 30.24 20 30 20 30.24 S 0 17.28 4 8.64 C 8 0 16 0 20 9"></path>
                </svg>
              </div>
            </div>
            <div class="description" style="padding: 8px;">
              <div class="price" style="font-size: 1.2em; font-weight: bolder;">$263,000</div>
              <div class="info" style="font-size: 0.75em;">2 bds 3 ba 1,900 sqft - For sale by realtor</div>
              <div class="address" style="font-size: 0.75em;">120 North Ballas Road, Kirkwood, MO 63122</div>
            </div>
          </div>
          <!-- Card content -->
        </div>
        <!-- ... Additional cards ... -->
      </div>
    </div>

    <!-- The remaining half of the page -->
    <!--    <div class="col-6">-->
    <!--      &lt;!&ndash; Content for the right half of the page &ndash;&gt;-->
    <!--    </div>-->
  </div>


</div>
<div id="map"></div>
<script>
  let map, marker, geoJsonData;

  async function initMap() {
    map = new google.maps.Map(document.getElementById('map'), {
      zoom: 12,
      center: { lat: 29.7604, lng: -95.3698 } // Default center (e.g., Houston, TX)
    });

    // 1776 Gessner Rd, Houston, TX 77080 outside bounds
    // 4701 Dickson St, Houston, TX 77007 within bounds


    // Fetch and display GeoJSON overlay
    geoJsonData = await fetchGeoJson('https://raw.githubusercontent.com/jeffrey840/zipcode_2/main/Hcc_districts_Geojson/merged_districts.geojson');
    if (geoJsonData) {
      map.data.addGeoJson(geoJsonData);
    }
  }

  async function fetchGeoJson(url) {
    try {
      const response = await fetch(url);
      return await response.json();
    } catch (error) {
      console.error("Error fetching GeoJSON data:", error);
      return null;
    }
  }

  async function checkPointInGeoJsonPolygon(geoJsonData, pointCoordinates) {
    if (geoJsonData && geoJsonData.features) {
      const polygon = geoJsonData.features[0].geometry;
      const point = turf.point(pointCoordinates);
      const isInside = turf.booleanPointInPolygon(point, polygon);

      if (!marker) {
        // Initialize the marker when first needed
        marker = new google.maps.Marker({
          position: { lat: pointCoordinates[1], lng: pointCoordinates[0] },
          map: map,
          title: 'Point Location'
        });
      } else {
        // Update the marker's position
        marker.setPosition({ lat: pointCoordinates[1], lng: pointCoordinates[0] });
      }

      alert(isInside ? "is within bounds" : "outside bounds");
    } else {
      alert('Failed to load or process GeoJSON data.');
    }
  }

  async function handleSearchInput(e) {
    if (e.key === 'Enter') {
      const address = document.getElementById('searchBox').value;
      const geocoder = new google.maps.Geocoder();

      try {
        const location = await geocodeAddress(geocoder, address);
        const pointCoordinates = [location.lng(), location.lat()];

        // Ensure GeoJSON data is loaded before proceeding
        if (geoJsonData) {
          checkPointInGeoJsonPolygon(geoJsonData, pointCoordinates);
        } else {
          alert("GeoJSON data is not yet loaded. Please try again.");
        }
      } catch (error) {
        alert(error);
      }
    }
  }

  async function geocodeAddress(geocoder, address) {
    return new Promise((resolve, reject) => {
      geocoder.geocode({ 'address': address }, (results, status) => {
        if (status === 'OK') {
          resolve(results[0].geometry.location);
        } else {
          reject('Geocode was not successful for the following reason: ' + status);
        }
      });
    });
  }

  function getUserLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition((position) => {
        const pointCoordinates = [position.coords.longitude, position.coords.latitude];
        checkPointInGeoJsonPolygon(geoJsonData, pointCoordinates);
      }, () => {
        alert('Error getting your location.');
      });
    } else {
      alert('Geolocation is not supported by this browser.');
    }
  }






  document.getElementById('searchBox').addEventListener('keydown', handleSearchInput);
  document.getElementById('checkLocationBtn').addEventListener('click', getUserLocation);
  initMap();
</script>
</body>
</html>
