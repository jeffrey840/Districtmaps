<!-- path/filename: dynamic-dropdown.html -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dynamic Dropdown</title>
  <style>
    /* Basic styling for dropdown */
    .dropdown {
      position: relative;
      display: inline-block;
    }

    .dropdown-content {
      display: none;
      position: absolute;
      background-color: #f9f9f9;
      min-width: 160px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 1;
    }

    .dropdown-content a {
      color: black;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
    }

    .dropdown:hover .dropdown-content {
      display: block;
    }
    .option-button.selected {
      background-color: #007bff;
      color: white;
    }

  </style>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>



<nav>
  <ul>
    <li class="dropdown">
      <a href="#" id="dropdown-title">For Sale</a>
      <div class="dropdown-content">
        <a href="#" class="sale-option" onclick="updateSaleTitle('ForSale')">For Sale</a>
        <a href="#" class="sale-option" onclick="updateSaleTitle('ForRent')">For Rent</a>
        <a href="#" class="sale-option" onclick="updateSaleTitle('RecentlySold')">Sold</a>
      </div>
    </li>
  </ul>

  <ul>
    <!-- Price Range Dropdown -->
    <li class="dropdown">
      <a href="#" id="price-range-title">Price Range</a>
      <div class="dropdown-content">
        <form id="price-range-form">
          <label for="min-price">Minimum</label>
          <input type="number" id="min-price" placeholder="Enter number">
          <label for="max-price">Maximum</label>
          <select id="max-price">
            <!-- Options added via JavaScript -->
          </select>
          <button type="button" onclick="applyPriceRange()">Apply</button>
        </form>
      </div>
    </li>
  </ul>

  <ul>
    <!-- Beds & Baths Dropdown -->
    <li class="dropdown">
      <a href="#" id="beds-baths-title">Beds & Baths</a>
      <div class="dropdown-content">
        <div id="bedroom-options">
          <span>Bedrooms:</span>
          <!-- Bedroom option buttons -->
          <button class="option-button" onclick="selectOption('bedrooms', 'any')">Any</button>
          <button class="option-button" onclick="selectOption('bedrooms', 1)">1</button>
          <button class="option-button" onclick="selectOption('bedrooms', 2)">2</button>
          <button class="option-button" onclick="selectOption('bedrooms', 3)">3</button>
          <button class="option-button" onclick="selectOption('bedrooms', 4)">4</button>
          <button class="option-button" onclick="selectOption('bedrooms', 5)">5</button>

        </div>
        <div id="bathroom-options">
          <span>Bathrooms:</span>
          <!-- Bathroom option buttons -->
          <button class="option-button" onclick="selectOption('bathrooms', 'any')">Any</button>
          <button class="option-button" onclick="selectOption('bathrooms', 1)">1</button>
          <button class="option-button" onclick="selectOption('bathrooms', 2)">2</button>
          <button class="option-button" onclick="selectOption('bathrooms', 3)">3</button>
          <button class="option-button" onclick="selectOption('bathrooms', 4)">4</button>
          <button class="option-button" onclick="selectOption('bathrooms', 5)">5</button>
        </div>
        <button type="button" onclick="applyBedsBaths()">Apply</button>
      </div>
    </li>
  </ul>

  <ul>
    <!-- Home Type Dropdown -->
    <li class="dropdown">
      <a href="#" id="home-type-title">Home Type</a>
<!--      <a href="#" id="home-type-title">Home Type</a>-->
      <div class="dropdown-content">
        <form id="home-type-form">
          <label>
            <input type="radio" name="select-all" onclick="toggleSelectAll(true)"> Select All
          </label>
          <label>
            <input type="radio" name="select-all" onclick="toggleSelectAll(false)"> Deselect All
          </label>
          <div>
            <label><input type="checkbox" name="home-type" value="House" onclick="updateHomeType()"> House</label>

            <label><input type="checkbox" name="home-type" value="town-home" onclick="updateHomeType()"> town home</label>

            <!-- Additional checkboxes for other home types -->
          </div>
          <button type="button" onclick="applyHomeType()">Apply</button>
        </form>
      </div>
    </li>
  </ul>

</nav>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
  $(document).ready(function() {
    // Populate max price dropdown
    const maxPriceSelect = $('#max-price');
    for (let i = 50000; i <= 1000000; i += 50000) {
      maxPriceSelect.append($('<option>', { value: i, text: `$${i.toLocaleString()}` }));
    }

    // Update titles on dropdown selection and log the current title
    $('.dropdown-content a').click(function() {
      const dropdownId = $(this).closest('.dropdown').find('a').first().attr('id');
      const newText = $(this).text();
      $('#' + dropdownId).text(newText);
      console.log(`Clicked on: ${newText}`);
    });

    // Price range interactions
    $('#min-price, #max-price').on('input change', function() {
      const minPrice = $('#min-price').val();
      const maxPrice = $('#max-price').val();
      const newText = `$${minPrice || '...'} - $${maxPrice || '...'}`;
      $('#price-range-title').text(newText);

      // Log the selected max price when focus is moved out of the max price input
      $('#max-price').on('blur', function() {
        console.log(`Max price selected: ${maxPrice}`);
      });
    });

    // Apply button for price range
    $('#price-range-form button').click(function() {
      const minPrice = $('#min-price').val();
      const maxPrice = $('#max-price').val();
      $('#price-range-title').text(`$${minPrice} - $${parseInt(maxPrice).toLocaleString()}`);
      console.log(`Price Range Applied: $${minPrice} - $${parseInt(maxPrice).toLocaleString()}`);
    });

    // Selecting options for beds and baths
    $('.dropdown-content .option-button').click(function() {
      $(this).toggleClass('selected').siblings().removeClass('selected');
      console.log(`Selected Option: ${$(this).text()}`);
    });

    // Apply button for beds and baths
    $('#beds-baths-title').siblings('.dropdown-content').find('button').click(function() {
      const bedrooms = $('#bedroom-options .option-button.selected').text() || 'any';
      const bathrooms = $('#bathroom-options .option-button.selected').text() || 'any';
      $('#beds-baths-title').text(`${bedrooms} bd, ${bathrooms} ba`);
      console.log(`Beds & Baths Applied: ${bedrooms} bd, ${bathrooms} ba`);
    });

    // Home Type functionality
    $('#home-type-form input[type="checkbox"]').change(function() {
      updateHomeTypeTitleAndLog();
      var selectedTypes = $('#home-type-form input[type="checkbox"]:checked').map(function() {
        return this.value;
      }).get();
      const newText = `Home Type (${selectedTypes.length})`;
      $('#home-type-title').text(newText);
      console.log(`Current 'home-type-title': ${newText}`);
    });

    $('#home-type-form input[type="radio"]').change(function() {
      updateHomeTypeTitleAndLog();
      var selectAll = $(this).val() === 'Select All';
      $('#home-type-form input[type="checkbox"]').prop('checked', selectAll).change();
    });

    $('#home-type-form button').click(function() {
      var selectedTypes = $('#home-type-form input[type="checkbox"]:checked').map(function() {
        return this.value;
      }).get();
      $('#home-type-title').text(`Home Type (${selectedTypes.length})`);
      console.log(`Home Type Applied: ${selectedTypes.length} Types Selected`);
    });

    function updateHomeTypeTitleAndLog() {
      var selectedTypes = $('#home-type-form input[type="checkbox"]:checked').map(function() {
        return this.value;
      }).get();
      var titleText = `Home Type (${selectedTypes.length})`;
      $('#home-type-title').text(titleText);
      console.log(`Home Type Applied: ${titleText}`);
    }

  });

</script>


<script>

  function updateSaleTitle(selectedOption) {
    // Update the title
    $('#dropdown-title').text(selectedOption);
    console.log(`----Selected option: ${selectedOption}`);

    // Assuming you want to call fetchHouses with some default values
    const minPrice = $('#min-price').val();
    const maxPrice = $('#max-price').val();
    const rentMinPrice = $('#rent-min-price').val();
    const rentMaxPrice = $('#rent-max-price').val();

    fetchHouses('98052', {}, selectedOption, minPrice, maxPrice, rentMinPrice, rentMaxPrice);
  }


  async function fetchHouses(zipCode, districtGeoJson, selectedOption, minPrice, maxPrice, rentMinPrice, rentMaxPrice) {
    const apiKey = '';
    const options = {
      method: 'GET',
      headers: {
        'X-RapidAPI-Key': apiKey,
        'X-RapidAPI-Host': 'zillow-com1.p.rapidapi.com'
      }
    };

    let url = `https://zillow-com1.p.rapidapi.com/propertyExtendedSearch?location=${zipCode}&status_type=${encodeURIComponent(selectedOption)}`;

    // Add price range parameters based on the selected option
    if (selectedOption === 'ForSale' || selectedOption === 'RecentlySold') {
      if (minPrice) url += `&minPrice=${minPrice}`;
      if (maxPrice) url += `&maxPrice=${maxPrice}`;
    } else if (selectedOption === 'ForRent') {
      if (rentMinPrice) url += `&rentMinPrice=${rentMinPrice}`;
      if (rentMaxPrice) url += `&rentMaxPrice=${rentMaxPrice}`;
    }

    console.log('Fetching houses from API:', url);
    const response = await fetch(url, options);
    const data = await response.json();

    console.log('Received data:', data);}

</script>



</body>
</html>
